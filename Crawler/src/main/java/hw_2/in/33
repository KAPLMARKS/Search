<!doctype html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover"> 
  <meta name="referrer" content="unsafe-url"> 
  <title>Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus / Хабр</title> 
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style> 
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.961b6771.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.55ca5167.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/css/app.d1834a6b.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/app.69ba180e.js" as="script"> 
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.961b6771.css">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.d1834a6b.css"> 
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.2822d469ec31a56409ac330bbcf7fcbf.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script> 
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/otus\/blog\/654867\/"},"headline":"Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus","datePublished":"2022-03-09T20:45:50+03:00","dateModified":"2022-03-09T22:02:51+03:00","author":{"@type":"Person","name":"KatMot"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Имплементация &laquo;выключателя мертвеца (Dead Man&rsquo;s Switch)&raquo; с помощью Opsgenie's HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет...","url":"https:\/\/habr.com\/ru\/company\/otus\/blog\/654867\/#post-content-body","about":["c_otus","h_kubernetes","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/654867\/04a0c4f67f0ae8139850df2e55ab26be\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/58f\/842\/f0d\/58f842f0d37ca359dfffbdf445a65963.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f17\/7f7\/e26\/f177f7e2602fbd29c5e03f754d674862.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/af3\/090\/7a2\/af30907a255fff7115203756511a31f9.png"]}</script> 
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script> 
  <style>.grecaptcha-badge{visibility: hidden;}</style> 
  <meta name="habr-version" content="2.66.0"> 
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613">
  <meta data-vue-meta="ssr" property="fb:pages" content="472597926099084">
  <meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image">
  <meta data-vue-meta="ssr" name="twitter:site" content="@habr_com">
  <meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name">
  <meta data-vue-meta="ssr" property="og:title" content="Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus" data-vmid="og:title">
  <meta data-vue-meta="ssr" name="twitter:title" content="Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus" data-vmid="twitter:title">
  <meta data-vue-meta="ssr" name="aiturec:title" content="Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus" data-vmid="aiturec:title">
  <meta data-vue-meta="ssr" name="description" content="Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&amp;#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:..." data-vmid="description">
  <meta data-vue-meta="ssr" itemprop="description" content="Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&amp;#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:..." data-vmid="description:itemprop">
  <meta data-vue-meta="ssr" property="og:description" content="Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&amp;#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:..." data-vmid="og:description">
  <meta data-vue-meta="ssr" name="twitter:description" content="Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&amp;#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:..." data-vmid="twitter:description">
  <meta data-vue-meta="ssr" property="aiturec:description" content="Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&amp;#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:..." data-vmid="aiturec:description">
  <meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" data-vmid="image:itemprop">
  <meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" data-vmid="og:image">
  <meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width">
  <meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" data-vmid="aiturec:image">
  <meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" data-vmid="twitter:image">
  <meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png?format=vk" data-vmid="vk:image">
  <meta data-vue-meta="ssr" property="aiturec:item_id" content="654867" data-vmid="aiturec:item_id">
  <meta data-vue-meta="ssr" property="aiturec:datetime" content="2022-03-09T17:45:50.000Z" data-vmid="aiturec:datetime">
  <meta data-vue-meta="ssr" content="https://habr.com/ru/company/otus/blog/654867/" property="og:url" data-vmid="og:url">
  <meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type">
  <meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale">
  <meta data-vue-meta="ssr" name="keywords" content="kubernetes, Prometheus, система мониторинга, service mesh, istio, envoy"> 
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/654867/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss">
  <link data-vue-meta="ssr" href="https://habr.com/ru/company/otus/blog/654867/" rel="canonical" data-vmid="canonical">
  <link data-vue-meta="ssr" data-vmid="hreflang">
  <link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" data-vmid="image:href">
  <link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/654867/"> 
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44"> 
  <meta name="msapplication-TileColor" content="#629FBC"> 
  <meta name="apple-mobile-web-app-capable" content="yes"> 
  <meta name="mobile-web-app-capable" content="yes"> 
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"> 
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"> 
  <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"> 
  <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest"> 
 </head> 
 <body> 
  <div id="app" data-server-rendered="true" data-async-called="true">
   <div class="tm-layout__wrapper">
    <!----> 
    <div></div> <!----> 
    <header class="tm-header">
     <div class="tm-page-width">
      <div class="tm-header__container">
       <!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru">
         <svg height="16" width="16" class="tm-svg-img tm-header__icon">
          <title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use>
         </svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> 
       <div class="tm-dropdown tm-header__projects">
        <div class="tm-dropdown__head">
         <button class="tm-header__dropdown-toggle">
          <svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown">
           <title>Открыть список</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#arrow-down"></use>
          </svg></button>
        </div> <!---->
       </div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn"> Как стать автором </a> <!----> <a href="https://effect.habr.com/a/NNC1v78I_n8OWuV_ynG1l0np2g3GMbCozioSSjtEHJvj0N1iEbSkCvc9-1eSMvtojytYpyuaDqISKwGs2Po_toiKdqZu8YrHLbuVs9fW1jeusBzPWU768LkLXsEH4xdHEopaeA" target="_blank" class="tm-top-link" style="color:#99ddff;"> Сработают ли в IT принципы космической подготовки </a> <!---->
      </div>
     </div>
    </header> 
    <div class="tm-layout">
     <div class="tm-page-progress-bar"></div> 
     <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky">
      <div class="tm-page-width">
       <div class="tm-base-layout__header-wrapper">
        <div class="tm-main-menu">
         <div class="tm-main-menu__section">
          <nav class="tm-main-menu__section-content">
           <!----> <a href="/ru/flows/all" class="tm-main-menu__item"> Все потоки </a> <a href="/ru/flows/develop/" class="tm-main-menu__item"> Разработка </a><a href="/ru/flows/admin/" class="tm-main-menu__item"> Администрирование </a><a href="/ru/flows/design/" class="tm-main-menu__item"> Дизайн </a><a href="/ru/flows/management/" class="tm-main-menu__item"> Менеджмент </a><a href="/ru/flows/marketing/" class="tm-main-menu__item"> Маркетинг </a><a href="/ru/flows/popsci/" class="tm-main-menu__item"> Научпоп </a>
          </nav>
         </div>
        </div> 
        <div class="tm-header-user-menu tm-base-layout__user-menu">
         <a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search">
          <svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark">
           <title>Поиск</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#search"></use>
          </svg></a> <!----> <!----> <!----> 
         <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop">
          <div class="tm-dropdown">
           <div class="tm-dropdown__head">
            <svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon">
             <title>Профиль</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#header-user"></use>
            </svg> <!---->
           </div> <!---->
          </div> <!---->
         </div> <!---->
        </div>
       </div>
      </div>
     </div> <!----> 
     <div class="tm-page-width"></div> 
     <main class="tm-layout__container">
      <div hl="ru" companyname="otus" data-async-called="true" class="tm-page">
       <div class="tm-page-width">
        <div class="tm-page__header">
         <!---->
        </div> 
        <div class="tm-page__wrapper">
         <div class="tm-page__main tm-page__main_has-sidebar">
          <div class="pull-down">
           <div class="pull-down__header" style="height:0px;">
            <div class="pull-down__content" style="bottom:10px;">
             <svg height="24" width="24" class="tm-svg-img pull-down__arrow">
              <title>Обновить</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#pull-arrow"></use>
             </svg>
            </div>
           </div> 
           <div class="tm-article-presenter">
            <div class="tm-company-profile-card tm-company-article__profile-card">
             <div class="tm-company-card tm-company-profile-card__info">
              <div class="tm-company-card__header">
               <a href="/ru/company/otus/profile/" class="tm-company-card__avatar">
                <div class="tm-entity-image">
                 <img alt="" height="48" src="//habrastorage.org/getpro/habr/company/968/422/761/968422761136a38a89fc391fd927f903.jpg" width="48" class="tm-entity-image__pic">
                </div></a> <!----> 
               <div class="tm-rating tm-company-card__rating">
                <div class="tm-rating__header"> 
                 <div class="tm-rating__counter">
                  299.06
                 </div>
                </div> 
                <div class="tm-rating__text">
                  Рейтинг 
                </div>
               </div> <!---->
              </div> 
              <div class="tm-company-card__info">
               <a href="/ru/company/otus/profile/" class="tm-company-card__name"> OTUS </a> 
               <div class="tm-company-card__description">
                Цифровые навыки от ведущих экспертов
               </div>
              </div>
             </div> <!---->
            </div> 
            <div class="tm-article-presenter__body">
             <div class="tm-misprint-area">
              <div class="tm-misprint-area__wrapper">
               <article class="tm-article-presenter__content tm-article-presenter__content_narrow">
                <div class="tm-article-presenter__header"> 
                 <div class="tm-article-snippet tm-article-presenter__snippet">
                  <div class="tm-article-snippet__meta-container">
                   <div class="tm-article-snippet__meta">
                    <span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/kmoseenk/" title="kmoseenk" class="tm-user-info__userpic">
                      <div class="tm-entity-image">
                       <svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink">
                        <!----> <use xlink:href="/img/megazord-v25.4b679db1.svg#placeholder-user"></use>
                       </svg>
                      </div></a> <span class="tm-user-info__user"><a href="/ru/users/kmoseenk/" class="tm-user-info__username"> kmoseenk </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2022-03-09T17:45:50.000Z" title="2022-03-09, 20:45">сегодня в 20:45</time></span>
                   </div> <!---->
                  </div> 
                  <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus</span></h1> 
                  <div class="tm-article-snippet__hubs">
                   <span class="tm-article-snippet__hubs-item"><a href="/ru/company/otus/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании OTUS</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/kubernetes/" class="tm-article-snippet__hubs-item-link"><span>Kubernetes</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span>
                  </div> 
                  <div class="tm-article-snippet__labels">
                   <div class="tm-article-snippet__label tm-article-snippet__label_variant-translation">
                    <span> Перевод </span>
                   </div>
                  </div> <!----> <!---->
                 </div>
                </div> 
                <div class="tm-article-presenter__origin">
                 <a href="https://engineering.hellofresh.com/who-monitors-the-monitoring-system-is-my-prometheus-alive-at-all-2789fd3647b3" target="_blank" class="tm-article-presenter__origin-link"> Автор оригинала: <span> Chris Loukas </span></a>
                </div> 
                <div data-gallery-root="" lang="ru" class="tm-article-body">
                 <div></div> 
                 <div id="post-content-body">
                  <div>
                   <div class="article-formatted-body article-formatted-body_version-2">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                     <figure class="full-width ">
                      <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png" width="780" height="439" data-src="https://habrastorage.org/getpro/habr/upload_files/58f/842/f0d/58f842f0d37ca359dfffbdf445a65963.png">
                      <figcaption></figcaption>
                     </figure>
                     <h3>Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie's Heartbeat</h3>
                     <p>В отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы: «Кто следит за системой мониторинга?»&nbsp;</p>
                     <p>Ответ не так прост, так как первым побуждением будет добавить систему, которая будет контролировать нашу службу мониторинга. Но тогда кто будет следить за этой системой?&nbsp;</p>
                     <p>Однако у этой проблемы есть решение: <a href="https://en.wikipedia.org/wiki/Dead_man%27s_switch#:~:text=A%20dead%20man's%20switch%20(see,being%20bodily%20removed%20from%20control."><u>Имплементация концепции Dead Man's Switch</u></a></p>
                     <p>Подытожим: до тех пор, пока система жива и здорова, отправляется heartbeat-сообщение. Если мы не получаем сигнал в течение некоторого времени, можно считать, что она мертва.</p>
                     <p>Эта концепция чрезвычайно уместна по двум основным причинам:</p>
                     <ol>
                      <li><p>Название "Dead Man’s Switch" — звучит очень круто!</p></li>
                      <li><p>Это самый надежный способ получить уведомление о выходе системы из строя.</p></li>
                     </ol>
                     <p>Главный недостаток такого подхода заключается в том, что очень сложно узнать, в чем причина сбоя.</p>
                     <h3>Мониторинг и оповещение в Hellofresh</h3>
                     <p>В Hellofresh мы де-факто используем стек Prometheus + Thanos. О нашем стеке мониторинга уже кратко рассказывалось в предыдущих постах, которые можно найти <a href="https://engineering.hellofresh.com/monitoring-at-hellofresh-part-1-architecture-677b4bd6b728"><u>здесь</u></a> и <a href="https://engineering.hellofresh.com/monitoring-at-hellofresh-part-2-operating-the-monitoring-system-8175cd939c1d"><u>здесь</u></a>.</p>
                     <p>Наш стек Thanos довольно прост: он скрейпит все наши prometheus-инсталляции и сохраняет метрики. Здесь нет ничего сложного.</p>
                     <p>Однако настройка Prometheus довольно сложная. Мы используем <a href="https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack"><u>helm чарт</u></a> kube-prometheus-stack для инсталляции одного Prometheus на пространство имен в кластерах Kubernetes (пространства имен связаны с внутренними кланами). Основная причина этого — распределение скрейпинга, достижение мелкомодульной масштабируемости в соответствии с потребностями различных кланов и гораздо более быстрые операции обновления/перезапуска.</p>
                     <p>Помимо этих двух компонентов, мы также используем Alertmanager как систему оповещения и Opsgenie в качестве системы пейджинга.</p>
                     <figure class="full-width ">
                      <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/f17/7f7/e26/f177f7e2602fbd29c5e03f754d674862.png" width="1075" height="1061" data-src="https://habrastorage.org/getpro/habr/upload_files/f17/7f7/e26/f177f7e2602fbd29c5e03f754d674862.png">
                      <figcaption></figcaption>
                     </figure>
                     <h4>Отдельный Prometheus-сценарий&nbsp;</h4>
                     <p>Имплементация <em>Dead Man’s Switch</em> для одной из наших Prometheus-инсталляций, показанных выше, довольно проста. Helm чарт даже поставляется с предварительно созданным алертом, как показано ниже:</p>
                     <figure class="full-width ">
                      <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/af3/090/7a2/af30907a255fff7115203756511a31f9.png" width="1077" height="398" data-src="https://habrastorage.org/getpro/habr/upload_files/af3/090/7a2/af30907a255fff7115203756511a31f9.png">
                      <figcaption></figcaption>
                     </figure>
                     <p>Затем мы создаем <a href="https://support.atlassian.com/opsgenie/docs/add-heartbeats-to-monitor-external-systems/,"><u>heartbeat в Opsgenie</u></a> для каждого алерта Watchdog, и все готово!</p>
                     <p>Или нет?</p>
                     <h4>Сценарий с несколькими Prometheus-инсталляциями&nbsp;</h4>
                     <p>В предыдущем подходе есть оговорка. Мы правильно реализовали Dead Man’s Switch для всех наших Prometheus-инсталляций, однако Alertmanager в данном случае является общим компонентом.</p>
                     <p>Это означает, что если Alertmanager выйдет из строя, наши дежурные операторы получат 14 различных оповещений о том, что Prometheus не работает, поскольку все opsgenie Heartbeats начнут выдавать пейджинг. Этого хотелось бы избежать, пусть даже придется отказаться от чего-то другого.</p>
                     <p>Вторая версия нашего решения заключается в преобразовании Dead Man's Switch в "catch-all" алерт. Он станет более «абстрактным» и высокоуровневым, а его срабатывание будет означать расплывчатое «Что-то не так в нашем стеке мониторинга».</p>
                     <p>Этим чем-то может быть любая из наших Prometheus-инсталляций, сам Alertmanager или даже thanos-ruler (поскольку теперь он тоже будет включен).</p>
                     <p>В итоге у нас получилось следующее правило, которое будет вычисляться в thanos-ruler:</p>
                     <pre><code>name: PrometheusHeartbeat
expr: count(sum by(job) (prometheus_build_info) &gt;= 1) == count(sum by(label_operator_prometheus_io_name) (kube_statefulset_labels{label_operator_prometheus_io_name!=””,namespace=”monitoring”}))
for: 1m</code></pre>
                     <p>Чтобы разложить это правило:</p>
                     <ul>
                      <li><p><code>count(sum by(job) (prometheus_build_info) &gt;= 1)</code><strong>:</strong> Это вернет количество работоспособных Prometheus-инсталляций. Работоспособная в данном контексте означает, что по крайней мере 1 из 2 реплик запущена и работает и что Prometheus можно соскрейпить (поскольку <code>prometheus_build_info</code> предоставляется самим Prometheus).</p></li>
                     </ul>
                     <ul>
                      <li><p><code>count(sum by(label_operator_prometheus_io_name)</code></p></li>
                     </ul>
                     <p><code>(kube_statefulset_labels{label_operator_prometheus_io_name!="",namespace="monitoring"}))</code><strong>:</strong> Это подсчитает количество контроллеров statefulset, определенных для Prometheus. Причина, по которой мы выбрали эту метрику, заключается в том, что она исходит из другого источника, нежели сам Prometheus (в данном случае — из kube-state-metrics). Это важно, поскольку данный запрос описывает наше работоспособное/желаемое состояние и не зависит от доступности Prometheus. Используемые метки специфичны для нашего случая использования (например, все наши Prometheus-инсталляции развернуты в пространстве имен мониторинга).</p>
                     <p>И соответствующий приемник согласуется с правилами в Alertmanager:</p>
                     <pre><code>config:
 route:
 group_by: [‘destination_app’, ‘alertname’, ‘job’]
 group_wait: 30s
 group_interval: 10m
 repeat_interval: 12h
 receiver: ‘slack-receiver’ routes:
   — match:
   alertname: ‘PrometheusHeartbeat’
   repeat_interval: 1m
   group_interval: 1m
   receiver: opsgenie-heartbeatreceivers:
 — name: opsgenie-heartbeat
 webhook_configs:
 — url: ‘https://api.opsgenie.com/v2/heartbeats/prom-heartbeat/ping’
 send_resolved: false
 http_config:
 authorization:
 type: GenieKey
 credentials: “”</code></pre>
                     <p>Однако при использовании этого подхода есть серьезный недостаток. Как только дежурный инженер получает пейджинг, у него нет подробной информации о том, что именно случилось. Вот почему важно объединить такое пейджинговый алерт с действительно простым в выполнении и использовании runbook. В нашем случае, к счастью, так как все развернуто на Kubernetes, существует несколько быстрых команд из runbooks для определения виновного в подобной ситуации.</p>
                     <p>Принятие концепции <em>Dead Man's Switch</em> является одним из самых надежных способов получения уведомлений о состоянии вашего стека мониторинга. И, как вы видите, существует множество способов ее реализации. Каждый из них имеет свои преимущества и недостатки. Если вы используете одну Prometheus-инсталляцию, то можете просто использовать Watchdog-алерт, о котором мы говорили ранее, и не переживать о других проблемах. Если у вас несколько установок Prometheus, то решение может быть немного сложнее. Об этом говорилось во втором варианте нашего решения.</p>
                     <hr>
                     <p>Всех желающих приглашаем на открытый урок «Service mesh. Знакомство с Istio и Envoy». Разберем, что такое service mesh вообще и познакомимся с одним из его представителей — Istio. Научимся устанавливать его в кластер и настраивать политики по управлению трафиком. Регистрация по <a href="https://otus.pw/Q1U4Q/">ссылке.</a></p>
                    </div>
                   </div>
                  </div> 
                  <div class="v-portal" style="display:none;"></div>
                 </div> <!----> <!---->
                </div> 
                <div class="tm-article-presenter__meta">
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Теги:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bkubernetes%5D" class="tm-tags-list__link">kubernetes</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BPrometheus%5D" class="tm-tags-list__link">Prometheus</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0%20%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%D0%B0%5D" class="tm-tags-list__link">система мониторинга</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bservice%20mesh%5D" class="tm-tags-list__link">service mesh</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bistio%5D" class="tm-tags-list__link">istio</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Benvoy%5D" class="tm-tags-list__link">envoy</a></li>
                  </ul>
                 </div> 
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Хабы:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/company/otus/blog/" class="tm-hubs-list__link router-link-active"> Блог компании OTUS </a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/kubernetes/" class="tm-hubs-list__link"> Kubernetes </a></li>
                  </ul>
                 </div>
                </div>
               </article>
              </div> <!---->
             </div> 
             <div class="tm-article-sticky-panel">
              <div class="tm-data-icons tm-article-sticky-panel__icons">
               <div class="tm-article-rating tm-data-icons__item">
                <div class="tm-votes-meter tm-article-rating__votes-switcher">
                 <svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_appearance-article">
                  <title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-rating"></use>
                 </svg> <span title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+1</span>
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item">
                <svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon">
                 <title>Просмотры</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-views"></use>
                </svg> <span class="tm-icon-counter__value">358</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon">
                 <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                  <title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-favorite"></use>
                 </svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter"> 3 </span></button> <!----> 
               <div title="Поделиться" class="tm-sharing tm-data-icons__item">
                <button type="button" class="tm-sharing__button">
                 <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon">
                  <path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path>
                 </svg></button> 
                <div class="v-portal" style="display:none;"></div>
               </div> 
               <div class="v-portal" style="display:none;"></div>
              </div> 
             </div>
            </div> 
            <div class="v-portal" style="display:none;"></div> 
            <div class="tm-article-presenter__footer">
             <div class="tm-article-blocks">
              <!----> 
              <section class="tm-block tm-block_spacing-bottom">
               <!----> 
               <div class="tm-block__body tm-block__body_variant-balanced">
                <div class="tm-article-author">
                 <div class="tm-article-author__company">
                  <div class="tm-article-author__company-card">
                   <div class="tm-company-snippet">
                    <a href="/ru/company/otus/profile/" class="tm-company-snippet__logo-link">
                     <div class="tm-entity-image">
                      <img alt="" height="40" src="//habrastorage.org/getpro/habr/company/968/422/761/968422761136a38a89fc391fd927f903.jpg" width="40" class="tm-entity-image__pic">
                     </div></a> 
                    <div class="tm-company-snippet__info">
                     <a href="/ru/company/otus/profile/" class="tm-company-snippet__title">OTUS</a> 
                     <div class="tm-company-snippet__description">
                      Цифровые навыки от ведущих экспертов
                     </div>
                    </div>
                   </div> 
                   <div class="tm-article-author__buttons">
                    <!----> <!---->
                   </div>
                  </div> 
                  <div class="tm-article-author__company-contacts">
                   <a href="https://otus.ru" rel="noopener" target="_blank" class="tm-article-author__contact"> Сайт </a><a href="https://facebook.com/otus.ru" rel="noopener" target="_blank" class="tm-article-author__contact"> Facebook </a><a href="https://vk.com/club145052891" rel="noopener" target="_blank" class="tm-article-author__contact"> ВКонтакте </a><a href="https://telegram.me/Otusjava" rel="noopener" target="_blank" class="tm-article-author__contact"> Telegram </a>
                  </div> 
                  <div class="tm-article-author__separator"></div>
                 </div> 
                 <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article">
                  <div class="tm-user-card__info-container">
                   <div class="tm-user-card__header">
                    <div class="tm-user-card__header-data">
                     <a href="/ru/users/kmoseenk/" class="tm-user-card__userpic tm-user-card__userpic_size-40">
                      <div class="tm-entity-image">
                       <svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink">
                        <!----> <use xlink:href="/img/megazord-v25.4b679db1.svg#placeholder-user"></use>
                       </svg>
                      </div></a> 
                     <div class="tm-user-card__meta">
                      <div title=" 116 голосов " class="tm-karma tm-user-card__karma">
                       <div class="tm-karma__votes tm-karma__votes_positive">
                         20 
                       </div> 
                       <div class="tm-karma__text">
                         Карма 
                       </div>
                      </div> 
                      <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating">
                       <div class="tm-rating__header"> 
                        <div class="tm-rating__counter">
                         40
                        </div>
                       </div> 
                       <div class="tm-rating__text">
                         Рейтинг 
                       </div>
                      </div>
                     </div>
                    </div>
                   </div> 
                   <div class="tm-user-card__info tm-user-card__info_variant-article">
                    <div class="tm-user-card__title tm-user-card__title_variant-article">
                     <span class="tm-user-card__name tm-user-card__name_variant-article">KatMot</span> <a href="/ru/users/kmoseenk/" class="tm-user-card__nickname tm-user-card__nickname_variant-article"> @kmoseenk </a> <!---->
                    </div> 
                    <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Контент-менеджер</p>
                   </div>
                  </div> 
                  <div class="tm-user-card__buttons tm-user-card__buttons_variant-article">
                   <!----> <!----> <!----> <!----> <!---->
                  </div>
                 </div> <!---->
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!---->
              </section> 
              <div class="tm-article-blocks__comments">
               <div class="tm-article-page-comments">
                <div class="tm-article-comments-counter-link tm-article-comments-counter-button">
                 <a href="/ru/company/otus/blog/654867/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style">
                  <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted">
                   <title>Комментарии</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-comments"></use>
                  </svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментировать </span></a> <!---->
                </div>
               </div>
              </div> <!----> <!----> <!----> 
             </div>
            </div>
           </div>
          </div>
         </div> 
         <div class="tm-page__sidebar">
          <div class="tm-layout-sidebar">
           <div class="tm-layout-sidebar__placeholder_initial"></div> 
           <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;">
            <!----> 
            <section class="tm-block tm-block_spacing-bottom">
             <header class="tm-block__header">
              <h2 class="tm-block__title">Информация</h2> <!---->
             </header> 
             <div class="tm-block__body">
              <div class="tm-company-basic-info">
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Дата основания
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                 <time datetime="2017-03-31T21:00:00.000Z" title="2017-04-01, 00:00">1 апреля 2017</time>
                </dd>
               </dl> 
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Местоположение
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                  Россия 
                </dd>
               </dl> 
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Сайт
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                 <a href="https://otus.ru" target="_blank" class="tm-company-basic-info__link"> otus.ru </a>
                </dd>
               </dl> 
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Численность
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                  51–100 человек 
                </dd>
               </dl> 
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Дата регистрации
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                 <time datetime="2017-03-22T08:17:26.000Z" title="2017-03-22, 11:17">22 марта 2017</time>
                </dd>
               </dl> 
               <dl class="tm-description-list tm-description-list_variant-columns-nowrap">
                <dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">
                 Представитель
                </dt> 
                <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
                 <a href="/ru/users/MaxRokatansky/" class="tm-company-basic-info__link"> OTUS </a>
                </dd>
               </dl>
              </div>
             </div> <!---->
            </section> 
            <div class="tm-company-widgets"></div> <!----> <!---->
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </main> <!---->
    </div> 
    <div class="tm-footer-menu">
     <div class="tm-page-width">
      <div class="tm-footer-menu__container">
       <div class="tm-footer-menu__block">
        <h3 class="tm-footer-menu__block-title"> Ваш аккаунт </h3> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/otus/blog/654867/&amp;hl=ru" rel="nofollow" target="_self"> Войти </a></li>
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/otus/blog/654867/&amp;hl=ru" rel="nofollow" target="_self"> Регистрация </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <h3 class="tm-footer-menu__block-title"> Разделы </h3> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active"> Публикации </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link"> Новости </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link"> Хабы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link"> Компании </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link"> Авторы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link"> Песочница </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <h3 class="tm-footer-menu__block-title"> Информация </h3> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link"> Устройство сайта </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link"> Для авторов </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link"> Для компаний </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link"> Документы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank"> Соглашение </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank"> Конфиденциальность </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <h3 class="tm-footer-menu__block-title"> Услуги </h3> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank"> Реклама </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank"> Тарифы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank"> Контент </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank"> Семинары </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link"> Мегапроекты </a></li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div> 
    <div class="tm-footer">
     <div class="tm-page-width">
      <div class="tm-footer__container">
       <!----> 
       <div class="tm-footer__social">
        <a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use>
         </svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use>
         </svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use>
         </svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use>
         </svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use>
         </svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use>
         </svg></a>
       </div> 
       <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><!----> Настройка языка </button> <a href="/ru/about" class="tm-footer__link"> О сайте </a> <a href="/ru/feedback/" class="tm-footer__link"> Техническая поддержка </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link"> Вернуться на старую версию </a> 
       <div class="tm-footer-copyright">
        <span class="tm-copyright"><span class="tm-copyright__years">© 2006–2022 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span>
       </div>
      </div>
     </div>
    </div> <!----> <!---->
   </div> 
   <div class="vue-portal-target"></div>
  </div> 
  <script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"654867":{"id":"654867","timePublished":"2022-03-09T17:45:50+00:00","isCorporative":true,"lang":"ru","titleHtml":"Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus","leadData":{"textHtml":"\u003Cp\u003EВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы: «Кто следит за системой мониторинга?»&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EОтвет не так прост, так как первым побуждением будет добавить систему, которая будет контролировать нашу службу мониторинга. Но тогда кто будет следить за этой системой?&nbsp;\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Chris Loukas","originalUrl":"https:\u002F\u002Fengineering.hellofresh.com\u002Fwho-monitors-the-monitoring-system-is-my-prometheus-alive-at-all-2789fd3647b3"}}],"author":{"scoreStats":{"score":20,"votesCount":116},"rating":40,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2723985","alias":"kmoseenk","fullname":"KatMot","avatarUrl":null,"speciality":"Контент-менеджер"},"statistics":{"commentsCount":0,"favoritesCount":3,"readingCount":358,"score":1,"votesCount":1},"hubs":[{"relatedData":null,"id":"21052","alias":"otus","type":"corporative","title":"Блог компании OTUS","titleHtml":"Блог компании OTUS","isProfiled":false},{"relatedData":null,"id":"22196","alias":"kubernetes","type":"collective","title":"Kubernetes","titleHtml":"Kubernetes","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png\" width=\"780\" height=\"439\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003EИмплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie's Heartbeat\u003C\u002Fh3\u003E\u003Cp\u003EВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы: «Кто следит за системой мониторинга?» \u003C\u002Fp\u003E\u003Cp\u003EОтвет не так прост, так как первым побуждением будет добавить систему, которая будет контролировать нашу службу мониторинга. Но тогда кто будет следить за этой системой? \u003C\u002Fp\u003E\u003Cp\u003EОднако у этой проблемы есть решение: \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FDead_man%27s_switch#:~:text=A%20dead%20man's%20switch%20(see,being%20bodily%20removed%20from%20control.\"\u003E\u003Cu\u003EИмплементация концепции Dead Man's Switch\u003C\u002Fu\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003EПодытожим: до тех пор, пока система жива и здорова, отправляется heartbeat-сообщение. Если мы не получаем сигнал в течение некоторого времени, можно считать, что она мертва.\u003C\u002Fp\u003E\u003Cp\u003EЭта концепция чрезвычайно уместна по двум основным причинам:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EНазвание \"Dead Man’s Switch\" — звучит очень круто!\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЭто самый надежный способ получить уведомление о выходе системы из строя.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EГлавный недостаток такого подхода заключается в том, что очень сложно узнать, в чем причина сбоя.\u003C\u002Fp\u003E\u003Ch3\u003EМониторинг и оповещение в Hellofresh\u003C\u002Fh3\u003E\u003Cp\u003EВ Hellofresh мы де-факто используем стек Prometheus + Thanos. О нашем стеке мониторинга уже кратко рассказывалось в предыдущих постах, которые можно найти \u003Ca href=\"https:\u002F\u002Fengineering.hellofresh.com\u002Fmonitoring-at-hellofresh-part-1-architecture-677b4bd6b728\"\u003E\u003Cu\u003Eздесь\u003C\u002Fu\u003E\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fengineering.hellofresh.com\u002Fmonitoring-at-hellofresh-part-2-operating-the-monitoring-system-8175cd939c1d\"\u003E\u003Cu\u003Eздесь\u003C\u002Fu\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EНаш стек Thanos довольно прост: он скрейпит все наши prometheus-инсталляции и сохраняет метрики. Здесь нет ничего сложного.\u003C\u002Fp\u003E\u003Cp\u003EОднако настройка Prometheus довольно сложная. Мы используем \u003Ca href=\"https:\u002F\u002Fartifacthub.io\u002Fpackages\u002Fhelm\u002Fprometheus-community\u002Fkube-prometheus-stack\"\u003E\u003Cu\u003Ehelm чарт\u003C\u002Fu\u003E\u003C\u002Fa\u003E kube-prometheus-stack для инсталляции одного Prometheus на пространство имен в кластерах Kubernetes (пространства имен связаны с внутренними кланами). Основная причина этого — распределение скрейпинга, достижение мелкомодульной масштабируемости в соответствии с потребностями различных кланов и гораздо более быстрые операции обновления\u002Fперезапуска.\u003C\u002Fp\u003E\u003Cp\u003EПомимо этих двух компонентов, мы также используем Alertmanager как систему оповещения и Opsgenie в качестве системы пейджинга.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff17\u002F7f7\u002Fe26\u002Ff177f7e2602fbd29c5e03f754d674862.png\" width=\"1075\" height=\"1061\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff17\u002F7f7\u002Fe26\u002Ff177f7e2602fbd29c5e03f754d674862.png\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch4\u003EОтдельный Prometheus-сценарий \u003C\u002Fh4\u003E\u003Cp\u003EИмплементация \u003Cem\u003EDead Man’s Switch\u003C\u002Fem\u003E для одной из наших Prometheus-инсталляций, показанных выше, довольно проста. Helm чарт даже поставляется с предварительно созданным алертом, как показано ниже:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faf3\u002F090\u002F7a2\u002Faf30907a255fff7115203756511a31f9.png\" width=\"1077\" height=\"398\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faf3\u002F090\u002F7a2\u002Faf30907a255fff7115203756511a31f9.png\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЗатем мы создаем \u003Ca href=\"https:\u002F\u002Fsupport.atlassian.com\u002Fopsgenie\u002Fdocs\u002Fadd-heartbeats-to-monitor-external-systems\u002F,\"\u003E\u003Cu\u003Eheartbeat в Opsgenie\u003C\u002Fu\u003E\u003C\u002Fa\u003E для каждого алерта Watchdog, и все готово!\u003C\u002Fp\u003E\u003Cp\u003EИли нет?\u003C\u002Fp\u003E\u003Ch4\u003EСценарий с несколькими Prometheus-инсталляциями \u003C\u002Fh4\u003E\u003Cp\u003EВ предыдущем подходе есть оговорка. Мы правильно реализовали Dead Man’s Switch для всех наших Prometheus-инсталляций, однако Alertmanager в данном случае является общим компонентом.\u003C\u002Fp\u003E\u003Cp\u003EЭто означает, что если Alertmanager выйдет из строя, наши дежурные операторы получат 14 различных оповещений о том, что Prometheus не работает, поскольку все opsgenie Heartbeats начнут выдавать пейджинг. Этого хотелось бы избежать, пусть даже придется отказаться от чего-то другого.\u003C\u002Fp\u003E\u003Cp\u003EВторая версия нашего решения заключается в преобразовании Dead Man's Switch в \"catch-all\" алерт. Он станет более «абстрактным» и высокоуровневым, а его срабатывание будет означать расплывчатое «Что-то не так в нашем стеке мониторинга».\u003C\u002Fp\u003E\u003Cp\u003EЭтим чем-то может быть любая из наших Prometheus-инсталляций, сам Alertmanager или даже thanos-ruler (поскольку теперь он тоже будет включен).\u003C\u002Fp\u003E\u003Cp\u003EВ итоге у нас получилось следующее правило, которое будет вычисляться в thanos-ruler:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Ename: PrometheusHeartbeat\nexpr: count(sum by(job) (prometheus_build_info) \u003E= 1) == count(sum by(label_operator_prometheus_io_name) (kube_statefulset_labels{label_operator_prometheus_io_name!=””,namespace=”monitoring”}))\nfor: 1m\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЧтобы разложить это правило:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Ecount(sum by(job) (prometheus_build_info) \u003E= 1)\u003C\u002Fcode\u003E\u003Cstrong\u003E:\u003C\u002Fstrong\u003E Это вернет количество работоспособных Prometheus-инсталляций. Работоспособная в данном контексте означает, что по крайней мере 1 из 2 реплик запущена и работает и что Prometheus можно соскрейпить (поскольку \u003Ccode\u003Eprometheus_build_info\u003C\u002Fcode\u003E предоставляется самим Prometheus).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Ecount(sum by(label_operator_prometheus_io_name)\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Ccode\u003E(kube_statefulset_labels{label_operator_prometheus_io_name!=\"\",namespace=\"monitoring\"}))\u003C\u002Fcode\u003E\u003Cstrong\u003E:\u003C\u002Fstrong\u003E Это подсчитает количество контроллеров statefulset, определенных для Prometheus. Причина, по которой мы выбрали эту метрику, заключается в том, что она исходит из другого источника, нежели сам Prometheus (в данном случае — из kube-state-metrics). Это важно, поскольку данный запрос описывает наше работоспособное\u002Fжелаемое состояние и не зависит от доступности Prometheus. Используемые метки специфичны для нашего случая использования (например, все наши Prometheus-инсталляции развернуты в пространстве имен мониторинга).\u003C\u002Fp\u003E\u003Cp\u003EИ соответствующий приемник согласуется с правилами в Alertmanager:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Econfig:\n route:\n group_by: [‘destination_app’, ‘alertname’, ‘job’]\n group_wait: 30s\n group_interval: 10m\n repeat_interval: 12h\n receiver: ‘slack-receiver’ routes:\n   — match:\n   alertname: ‘PrometheusHeartbeat’\n   repeat_interval: 1m\n   group_interval: 1m\n   receiver: opsgenie-heartbeatreceivers:\n — name: opsgenie-heartbeat\n webhook_configs:\n — url: ‘https:\u002F\u002Fapi.opsgenie.com\u002Fv2\u002Fheartbeats\u002Fprom-heartbeat\u002Fping’\n send_resolved: false\n http_config:\n authorization:\n type: GenieKey\n credentials: “”\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОднако при использовании этого подхода есть серьезный недостаток. Как только дежурный инженер получает пейджинг, у него нет подробной информации о том, что именно случилось. Вот почему важно объединить такое пейджинговый алерт с действительно простым в выполнении и использовании runbook. В нашем случае, к счастью, так как все развернуто на Kubernetes, существует несколько быстрых команд из runbooks для определения виновного в подобной ситуации.\u003C\u002Fp\u003E\u003Cp\u003EПринятие концепции \u003Cem\u003EDead Man's Switch\u003C\u002Fem\u003E является одним из самых надежных способов получения уведомлений о состоянии вашего стека мониторинга. И, как вы видите, существует множество способов ее реализации. Каждый из них имеет свои преимущества и недостатки. Если вы используете одну Prometheus-инсталляцию, то можете просто использовать Watchdog-алерт, о котором мы говорили ранее, и не переживать о других проблемах. Если у вас несколько установок Prometheus, то решение может быть немного сложнее. Об этом говорилось во втором варианте нашего решения.\u003C\u002Fp\u003E\u003Chr\u002F\u003E\u003Cp\u003EВсех желающих приглашаем на открытый урок «Service mesh. Знакомство с Istio и Envoy». Разберем, что такое service mesh вообще и познакомимся с одним из его представителей — Istio. Научимся устанавливать его в кластер и настраивать политики по управлению трафиком. Регистрация по \u003Ca href=\"https:\u002F\u002Fotus.pw\u002FQ1U4Q\u002F\"\u003Eссылке.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"kubernetes"},{"titleHtml":"Prometheus"},{"titleHtml":"система мониторинга"},{"titleHtml":"service mesh"},{"titleHtml":"istio"},{"titleHtml":"envoy"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58f\u002F842\u002Ff0d\u002F58f842f0d37ca359dfffbdf445a65963.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fotus\\\u002Fblog\\\u002F654867\\\u002F\"},\"headline\":\"Кто следит за системой мониторинга? — Вообще, живой ли мой Prometheus\",\"datePublished\":\"2022-03-09T20:45:50+03:00\",\"dateModified\":\"2022-03-09T22:02:51+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"KatMot\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Имплементация &laquo;выключателя мертвеца (Dead Man&rsquo;s Switch)&raquo; с помощью Opsgenie's HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fotus\\\u002Fblog\\\u002F654867\\\u002F#post-content-body\",\"about\":[\"c_otus\",\"h_kubernetes\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F654867\\\u002F04a0c4f67f0ae8139850df2e55ab26be\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F58f\\\u002F842\\\u002Ff0d\\\u002F58f842f0d37ca359dfffbdf445a65963.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff17\\\u002F7f7\\\u002Fe26\\\u002Ff177f7e2602fbd29c5e03f754d674862.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Faf3\\\u002F090\\\u002F7a2\\\u002Faf30907a255fff7115203756511a31f9.png\"]}","metaDescription":"Имплементация «выключателя мертвеца (Dead Man’s Switch)» с помощью Opsgenie&#039;s HeartbeatВ отношении систем мониторинга существует простой вопрос, который приведет к появлению нескончаемой проблемы:...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"otus":{"alias":"otus","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F968\u002F422\u002F761\u002F968422761136a38a89fc391fd927f903.jpg","titleHtml":"OTUS","descriptionHtml":"Цифровые навыки от ведущих экспертов","relatedData":null,"statistics":{"postsCount":1703,"newsCount":3,"vacanciesCount":0,"employeesCount":55,"careerRating":null,"subscribersCount":76327,"rating":299.06,"invest":null},"foundationDate":{"year":"2017","month":"04","day":"01"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fotus.ru","staffNumber":"51–100 человек","registrationDate":"2017-03-22T08:17:26+00:00","representativeUser":{"alias":"MaxRokatansky","fullname":"OTUS"},"contacts":[{"title":"Сайт","url":"https:\u002F\u002Fotus.ru"},{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002Fotus.ru"},{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Fclub145052891"},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002FOtusjava"}],"settings":{"analyticsSettings":[],"branding":null,"status":"active","isStartup":false},"metadata":{"titleHtml":"OTUS, Москва - Цифровые навыки от ведущих экспертов с 1 апреля 2017 г.","title":"OTUS, Москва - Цифровые навыки от ведущих экспертов с 1 апреля 2017 г.","keywords":["Программирование","Тестирование веб-сервисов","Java","Машинное обучение","Python","python","java","javascript","программирование","devops","data science","linux","machine learning","android","php","otus","kubernetes","qa","ios","web-разработка","машинное обучение","swift","kotlin","автоматизация тестирования","sql"],"descriptionHtml":"1 703 статьи от авторов компании OTUS","description":"1 703 статьи от авторов компании OTUS"},"aDeskSettings":null,"careerAlias":"otus"}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":true,"featurer":[],"megaposts":[{"title":"Сработают ли в IT принципы космической подготовки","color":"#99ddff","link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FNNC1v78I_n8OWuV_ynG1l0np2g3GMbCozioSSjtEHJvj0N1iEbSkCvc9-1eSMvtojytYpyuaDqISKwGs2Po_toiKdqZu8YrHLbuVs9fW1jeusBzPWU768LkLXsEH4xdHEopaeA"},"events":{"view":"eYlXDozaAYiEXfK_RY9W0eLfn0rBhCAFxlqRq-yG5CsU9q56UaO_h8em2DAxf-hbMXJ6plXGL-AsQA"}}],"promoLinks":[{"title":"Делаем торт вместе: собираем темы, которых вам не хватает на Хабре","label":"Опрос","external":false,"link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FB_hBgwNSQNAYnBywL-jVfXx7wBGidJgFWRjBwkTNmvcy7kdN028o4jTiHPZrpy2vc2bJFtmaDwUNtAgM_m_jKUcIStWhKkMFPYwWDLPtsounftIsW6mHS66emz_9"},"events":{"view":"2hqNAeFVhOL2dcNdw3T7XL_nkNX4sCgY2JqIDI2EQGS87lAHspaABJVeW50MM-RTzFF-tkA8ruu9Fg"}},{"title":"Собрали со всего Хабра самую полезную инфу о платёжных технологиях","label":"Коллекция","external":false,"link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FzLcEmU8ZbmPFkpIw6TK-nM3r7kiurzk79jLGdGcQj8tZq8RjAErvsDfp-nn5Slvqb3ROTBE2hKAMAFMfvFWnMY-Fbcl_l9bv9N5leoXyIq_dnOez"},"events":{"view":"krXtxQsUG4ub4VyE9O-Pcup5Lx8hBMQCop7I7iV9RpFceDPC92APTui1TYQLSoz9y76N0fHY877wOw"}}],"promoPosts":[{"title":"Красивое: смотрим тренды рынка труда в IT вместе с вами","label":"Промо","external":true,"image":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FPIeWhpXMNZNAOpN3Kh3klje-S2URzi6SI_88FT2GB_Of61TKlM6bVyBzYM4CC1VHg15dsoZt8woEiLxa4ajKb4OwjR2_2K0rZXuDiOWyAHL3fzREgeRqL6rp3NHsDoXPwOps8t331MtRh-jMYVfY3ffCxjAKTKmPBbAVaw4rQvlcsXHHQMfr1LcXIeT_nVli2jR4iTTe_VKguthT"},"link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FjNrhNkOQ1WqpNm7kLlaVEpkxVbqob7JJsQv2lkBvSGUCsL9PJLk7FeyIyxZeGKmwjN4Cq2lnZUAS54Qsrr6JIx27EnhauYsUNn2xN7FV34y2QhPoBswAzCWtsqJ45bnuIyKXdCKxbFEHteiF72aSAxvfpVnKFjU"}},{"title":"Истощающая тревога: что такое стресс и как с ним бороться","label":"Интересно","external":false,"image":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002Fd1pEDaY2sUeKIFD-_IZMuaOOAzSUEuDjndACHOAfQ3xF_2pzf_lqngG6xB2Y-JT2v8Hr4GNUOADQXvcSjMelrAqX2RE-t-9XvbmscZJKSqzH7xDpkPpBLAc6S7MMvanoaYwgiS5KTnmT-RurxyGKfTew6OoGcg3TVAy8NmDMPB9v1zu_sodGtHgjvCKiIieVewoqkhiPuRM0"},"link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002F5whVXVtUNINld2TpqU9Ps9WGsZQ6FRLwAg2qTwUUIPHuCnHRDXty1_BGckS7muXBz6IFS5zQpzathedNwX8E3Y2Vq5qrn8IOQe1nMY0w20APVmuPKekI7NO3zdQLJjacP7BeVyIpzg"}},{"title":"Зарплаты айтишников во втором полугодии 2021","label":"Мегапост","external":false,"image":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002Fq0cR2C4L2TL2xvUUkgPxYRlDM5lxr6h39dArp4bbMDf3VXphXmEx2VoK2USa2Qa0xgy7p-tqhviDKWSSEZbz1xkRl0kPEznQJa7mLO2MQvW5BPBFL0kZHVLrr5sgn8dbPqi0-T8Z5DA4j-6Y4kcgxV7FpnoGHbBVS47xWIvjCXdVsQxOFC_UTiXEScZeif7o0ckvnrV2rmsnmN9-MRU"},"link":{"url":"https:\u002F\u002Feffect.habr.com\u002Fa\u002FAzgzVSBgiSCjF1GacH6J4MIrRJKBcYKy5BS8nj46_LtLyJED0jtAHzHYs3Ocy_aDcZBJ0-oKKGFgloeTu7RC4a-eJbsjYonEjKE7vJeuHXbPn9TM3W4igVdN2sa_"}}]},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"in